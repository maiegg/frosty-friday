**This was my first time using TASKs! :hatching_chick:**

First, I modified the CTAS to include some data types, because by default columns were getting inferred varchar's of maximum length:
```
create or replace table week11 as
select TO_TIMESTAMP(m.$1) as milking_datetime,
        m.$2 as cow_number,
        CAST(m.$3 AS NUMBER) as fat_percentage,
        m.$4 as farm_code,
        TO_TIMESTAMP(m.$5) as centrifuge_start_time,
        TO_TIMESTAMP(m.$6) as centrifuge_end_time,
        m.$7 as centrifuge_kwph,
        m.$8 as centrifuge_electricity_used,
        m.$9 as centrifuge_processing_time,
        NULLIF(m.$10,'NULL') as task_used
from @week_11_frosty_stage (file_format => 'csv_ff', pattern => '.*milk_data.*[.]csv') m;

```
I defined the two simple tasks as follows:
```
CREATE OR REPLACE TASK whole_milk_updates
schedule = '1400 minutes'
AS
UPDATE week11 
SET 
    centrifuge_start_time = NULL,
    centrifuge_end_time = NULL,
    centrifuge_kwph = NULL,
    task_used = COALESCE(task_used, '') || ' Updated centrifuge dates and kwph to null where fat = 3.'
WHERE fat_percentage = 3;
```


```
CREATE OR REPLACE TASK skim_milk_updates 
    AFTER whole_milk_updates 
AS 
UPDATE week11
SET 
    centrifuge_processing_time = DATEDIFF('second'
        , centrifuge_start_time
        , centrifuge_end_time
        ),
    task_used = COALESCE(task_used, '') || ' Added centrifuge processing time where fat != 3.'
WHERE fat_percentage != 3;
```

**This challenge, intentionally or otherwise, taught something interesting about task chaining in Snowflake.**

As originally suggested in the template SQL, `whole_milk_updates` should be manually executed with `EXECUTE <task name>`. 

*However*, this will not trigger `skim_milk_updates` by itself! Per [docs](https://docs.snowflake.com/en/user-guide/tasks-graphs), you must execute `ALTER TASK ... RESUME` on each child task in a graph if you want to execute manually. 

The execution then becomes:
```
ALTER TASK skim_milk_updates RESUME;
EXECUTE TASK whole_milk_updates;
```
And checked with:
```
-- Check that the data looks as it should.
select *
from 
(select * from week11 where fat_percentage = 3 limit 5;)
union 
(select * from week11 where fat_percentage != 3 limit 5);
```

